/* ============================================
   ECS Advanced Chatbot System
   ============================================ */

class ECSchatbot {
    constructor() {
        this.whatsappNumber = '201153611556';
        this.responses = this.initResponses();
        this.context = [];
        this.init();
    }

    initResponses() {
        return {
            greetings: [
                'ูุฑุญุจุงู ุจู ูู ECS! ๐ ููู ูููููู ูุณุงุนุฏุชู ุงููููุ',
                'ุฃููุงู ูุณููุงู! ุฃูุง ูุณุงุนุฏู ุงูุฐูู ูู ECS. ูุง ุงูุฐู ุชุจุญุซ ุนููุ',
                'ูุฑุญุจุงู! ุณุนูุฏ ุจุฎุฏูุชู. ููู ุฃุณุชุทูุน ูุณุงุนุฏุชูุ',
                'ุฃููุงู! ุชุญุช ุฃูุฑู ูู ุฃู ุงุณุชูุณุงุฑ ๐',
                'ูุง ููุง! ุงุฒููุ ุนุงูุฒ ุชุนุฑู ุญุงุฌุฉ ุนู ุฎุฏูุงุชูุงุ'
            ],
            
            thanks: {
                keywords: ['ุดูุฑุง', 'ุดูุฑุงู', 'ุชุณูู', 'ููุชุงุฒ', 'ุฑุงุฆุน', 'ุฌููู', 'thanks', 'ูุชุดูุฑ', 'ุงููู ูุฎููู'],
                response: 'ุงูุนูู! ๐ ุฃู ุฎุฏูุฉ ุชุงููุฉ ุชุญุชุงุฌูุงุ'
            },
            
            help: {
                keywords: ['ูุณุงุนุฏุฉ', 'ุณุงุนุฏูู', 'help', 'ุนุงูุฒ', 'ูุญุชุงุฌ', 'ูููู'],
                response: 'ุทุจุนุงู! ุฃูุง ููุง ุนุดุงู ุฃุณุงุนุฏู ๐ช\n\nูููู ุชุณุฃููู ุนู:\n' +
                         'โข ๐ง ุงูุฎุฏูุงุช ูุงููุนุฏุงุช\n' +
                         'โข ๐ท ุงููุฑู ุงููุณุงุญูุฉ\n' +
                         'โข ๐ ุงูููุฑุณุงุช ุงูุชุฏุฑูุจูุฉ\n' +
                         'โข ๐ป ุงูุจุฑุงูุฌ ุงูุญุตุฑูุฉ\n' +
                         'โข ๐ฐ ุงูุฃุณุนุงุฑ\n' +
                         'โข ๐ ุงูุชูุงุตู ูุงูููุงุนูุฏ\n\n' +
                         'ุงุณุฃู ุจุฑุงุญุชู! ๐'
            },
            
            services: {
                keywords: ['ุฎุฏูุงุช', 'ุฎุฏูุงุชูู', 'ุชูุฏููู', 'ุชูุฏููุง', 'ุงูู ุงููู', 'ุดุบููู', 'ุจุชุนูููุง', 'ุชุนูููุง ุงูู', 
                          'ูููู ุชุนูููุง', 'ุนูุฏูู ุงูู', 'ุงูู ุงูุฎุฏูุงุช', 'ุดุบูููุง ุงูู', 'ุจุชุดุชุบููุง', 'services',
                          'ุงุนุฑู ุฎุฏูุงุชูู', 'ูููู ุนู ุงูุฎุฏูุงุช', 'ููู ุงูู', 'ูุชุฎุตุตูู ูู ุงูู'],
                response: 'ูุญู ูู ECS ููุฏู ุฎุฏูุงุช ูุชูุงููุฉ ูู ูุฌุงู ุงููุณุงุญุฉ:\n\n' +
                         '๐ **ุฃุนูุงู ุงููุณุงุญุฉ:**\n' +
                         '   โข ุงููุณุงุญุฉ ุงูุฃุฑุถูุฉ ุจุฏูุฉ ุงูููููุชุฑ\n' +
                         '   โข ุงููุณุงุญุฉ ุงูุฌููุฉ ุจุงูุฏุฑูู\n' +
                         '   โข ุฑูุน ูุณุงุญู ูููุดุงุฑูุน\n\n' +
                         '๐ฐ๏ธ **ุงูุฃุฌูุฒุฉ ูุงููุนุฏุงุช:**\n' +
                         '   โข ุฅูุฌุงุฑ Total Station\n' +
                         '   โข ุฅูุฌุงุฑ GPS/GNSS\n' +
                         '   โข ุฃุฌูุฒุฉ Laser ู Level\n\n' +
                         '๐ฅ **ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ:**\n' +
                         '   โข ูุฑู ูุณุงุญูุฉ ูุงููุฉ\n' +
                         '   โข ูููุฏุณูู ูุนุชูุฏูู\n' +
                         '   โข ููููู ุฐูู ุฎุจุฑุฉ\n\n' +
                         '๐ **ุงูุชุฏุฑูุจ:**\n' +
                         '   โข ููุฑุณุงุช Civil 3D\n' +
                         '   โข ููุฑุณุงุช AutoCAD ู GIS\n' +
                         '   โข ุชุฏุฑูุจ ุนููู ุนูู ุงูุฃุฌูุฒุฉ\n\n' +
                         '๐ป **ุงูุจุฑุงูุฌ ุงูุญุตุฑูุฉ:**\n' +
                         '   โข ุจุฑุงูุฌ ุญุณุงุจุงุช ูุณุงุญูุฉ\n' +
                         '   โข ุชุทุจููุงุช ููุนุงูุฌุฉ ุงูุจูุงูุงุช\n\n' +
                         'ุนุงูุฒ ุชูุงุตูู ุฃูุชุฑ ุนู ุฎุฏูุฉ ูุนููุฉุ ๐ค'
            },
            
            equipment: {
                keywords: ['ุฃุฌูุฒุฉ', 'ุฌูุงุฒ', 'ูุนุฏุงุช', 'ูุนุฏู', 'ุชูุชุงู', 'total', 'station', 'gps', 'ุงูุฌุงุฑ', 'ุงุณุชุฆุฌุงุฑ',
                          'ุนุงูุฒ ุงุฌุฑ', 'ูุญุชุงุฌ ุฌูุงุฒ', 'ูููู ุชุฃุฌุฑูุง', 'ุงูุฃุฌูุฒุฉ ุงููุชุงุญุฉ', 'ุนูุฏูู ุงุฌูุฒู',
                          'laser', 'ููุฒุฑ', 'level', 'leica', 'trimble', 'topcon', 'ูููู', 'ุฌู ุจู ุงุณ',
                          'ุงุฌูุฒุฉ ูุณุงุญุฉ', 'ูุนุฏุงุช ูุณุงุญูุฉ', 'ุนุงูุฒ ุงุณุชุฃุฌุฑ', 'ูููู ุงูุฌุงุฑ'],
                response: '๐๏ธ **ุงูุฃุฌูุฒุฉ ุงููุชุงุญุฉ ููุฅูุฌุงุฑ:**\n\n' +
                         '**๐ก Total Stations:**\n' +
                         '   โข Leica TS16 (ุฏูุฉ 1")\n' +
                         '   โข Topcon ES-105 (ุฏูุฉ 5")\n' +
                         '   โข Trimble S9 (ุฏูุฉ 0.5")\n' +
                         '   โข ุฌููุนูุง Reflectorless\n\n' +
                         '**๐ฐ๏ธ ุฃุฌูุฒุฉ GPS/GNSS:**\n' +
                         '   โข Leica GS18\n' +
                         '   โข Trimble R12\n' +
                         '   โข ุฏูุฉ RTK ุนุงููุฉ\n\n' +
                         '**๐ ุฃุฌูุฒุฉ ููุงุณ ุฅุถุงููุฉ:**\n' +
                         '   โข Laser Distance Meters\n' +
                         '   โข Digital Levels\n' +
                         '   โข Prisms & Targets\n\n' +
                         'โ **ุงููููุฒุงุช:**\n' +
                         '   โ ุตูุงูุฉ ุฏูุฑูุฉ ูุฌุงููุฉ\n' +
                         '   โ ุฏุนู ููู 24/7\n' +
                         '   โ ุชุฏุฑูุจ ุนูู ุงูุงุณุชุฎุฏุงู\n' +
                         '   โ ุชูุตูู ูุฌููุน ุงููุญุงูุธุงุช\n' +
                         '   โ ุฃุณุนุงุฑ ุชูุงูุณูุฉ\n\n' +
                         'ุนุงูุฒ ุชุนุฑู ุงูุณุนุฑุ ุงุถุบุท ุนูู ุฒุฑ ูุงุชุณุงุจ! ๐ฑ'
            },
            
            teams: {
                keywords: ['ูุฑูู', 'ูุฑู', 'ูููุฏุณูู', 'ูููุฏุณ', 'ููููู', 'ููู', 'ุนูุงู', 'ููุธููู', 'ุนุงูู',
                          'ูุญุชุงุฌ ูุฑูู', 'ุนุงูุฒ ูุงุณ', 'ูููู ุชููุฑูุง', 'ุนูุฏูู ูููุฏุณูู', 'ูุฑูู ุนูู',
                          'team', 'ูุญุชุงุฌ ุญุฏ', 'ูููู ุชูุฌูุง', 'ุชูุฏุฑูุง ุชุดุชุบููุง', 'ุนุงูุฒ ุญุฏ ูุดุชุบู'],
                response: '๐ท **ุงููุฑู ุงููุณุงุญูุฉ ุงููุชุงุญุฉ:**\n\n' +
                         '**๐น ุงููุฑูู ุงูุฃุณุงุณู (2-3 ุฃูุฑุงุฏ):**\n' +
                         '   โข 1 ูููุฏุณ ูุณุงุญุฉ\n' +
                         '   โข 2 ููู\n' +
                         '   โข ุฌูุงุฒ Total Station\n' +
                         '   โข ููุงุณุจ ูููุดุงุฑูุน ุงูุตุบูุฑุฉ\n\n' +
                         '**๐ธ ุงููุฑูู ุงูุงุญุชุฑุงูู (5+ ุฃูุฑุงุฏ):**\n' +
                         '   โข 2 ูููุฏุณ ุฎุจุฑุฉ\n' +
                         '   โข 3 ููููู ูุชุฎุตุตูู\n' +
                         '   โข Total Station + GPS + Level\n' +
                         '   โข ูููุดุงุฑูุน ุงููุชูุณุทุฉ\n\n' +
                         '**โญ ุงููุฑูู ุงููุชูุฏู (8+ ุฃูุฑุงุฏ):**\n' +
                         '   โข 3 ูููุฏุณูู ุฃูุฏููุฉ\n' +
                         '   โข 5+ ููููู ูุญุชุฑููู\n' +
                         '   โข ูุงูู ุงููุนุฏุงุช\n' +
                         '   โข ูููุดุงุฑูุน ุงููุจุฑู ูุงูููููุฉ\n\n' +
                         'โ **ูููุฒุงุช ูุฑููุง:**\n' +
                         '   โ ุฎุจุฑุฉ 10-15 ุณูุฉ\n' +
                         '   โ ุดุงุฑููุง ูู ูุดุงุฑูุน ูุจุฑู (ุงูุถุจุนุฉุ ุงูุนุงุตูุฉ)\n' +
                         '   โ ูุนุชูุฏูู ููุคููููู\n' +
                         '   โ ูุนูู ูู ุฌููุน ุงููุญุงูุธุงุช\n\n' +
                         'ุนุงูุฒ ุชุญุฌุฒ ูุฑููุ ุชูุงุตู ูุนุงูุง! ๐'
            },
            
            courses: {
                keywords: ['ููุฑุณ', 'ููุฑุณุงุช', 'ุฏูุฑุฉ', 'ุฏูุฑุงุช', 'ุชุฏุฑูุจ', 'ุชุนููู', 'ุชุนูู', 'civil', 'autocad', 'gis',
                          'ุนุงูุฒ ุงุชุนูู', 'ูุญุชุงุฌ ุงุชุฏุฑุจ', 'ููู ููุฑุณุงุช', 'ุนูุฏูู ุฏูุฑุงุช', 'ูููู ุงุชุฏุฑุจ',
                          'training', 'course', 'ุงุชุนูู ูุณุงุญุฉ', 'ุจุฑุงูุฌ ููุฏุณูุฉ', 'ุงูุชููุงุฏ', 'ุณูููู',
                          'ุนุงูุฒ ุฏูุฑุฉ', 'ูุญุชุงุฌ ุดูุงุฏุฉ', 'ุฏูุฑุฉ ุชุฏุฑูุจูุฉ', 'ุงุชุฏุฑุจ ุนูุฏูู'],
                response: '๐ **ุงูููุฑุณุงุช ุงูุชุฏุฑูุจูุฉ ุงููุชุงุญุฉ:**\n\n' +
                         '**๐ ุงูููุฑุณุงุช ุงูููุฏุณูุฉ:**\n' +
                         '   โข Civil 3D (ูู ุงูุตูุฑ ููุงุญุชุฑุงู)\n' +
                         '   โข AutoCAD (ูุจุชุฏุฆ โ ูุชูุฏู)\n' +
                         '   โข GIS ููุธู ุงููุนูููุงุช ุงูุฌุบุฑุงููุฉ\n' +
                         '   โข Global Mapper\n' +
                         '   โข Total Station (ุชุฏุฑูุจ ุนููู)\n\n' +
                         '**๐ป ููุฑุณุงุช ุงูุจุฑูุฌุฉ:**\n' +
                         '   โข HTML & CSS\n' +
                         '   โข JavaScript\n' +
                         '   โข C++ Programming\n\n' +
                         'โ **ุงููููุฒุงุช:**\n' +
                         '   โ ุดูุงุฏุงุช ูุนุชูุฏุฉ\n' +
                         '   โ ุชุฏุฑูุจ ุนููู ุนูู ูุดุงุฑูุน ุญููููุฉ\n' +
                         '   โ ูุฏุฑุจูู ุฎุจุฑุงุก (15+ ุณูุฉ)\n' +
                         '   โ ุฏุนู ุจุนุฏ ุงูุชูุงุก ุงูููุฑุณ\n' +
                         '   โ ูุฌููุนุงุช ุตุบูุฑุฉ (ุงูุชูุงู ุดุฎุตู)\n\n' +
                         '๐ก **ุจุงูุงุช ุฎุงุตุฉ:**\n' +
                         '   โข ุจุงูุฉ ุงููุณุงุญุฉ ุงูุดุงููุฉ\n' +
                         '   โข ุจุงูุฉ ุชุทููุฑ ุงูููุงูุน\n' +
                         '   โข ุงูุจุงูุฉ ุงููุงููุฉ (ูู ุงูููุฑุณุงุช)\n\n' +
                         'ุนุงูุฒ ุชุนุฑู ุชูุงุตูู ููุฑุณ ูุนููุ ๐ค'
            },
            
            software: {
                keywords: ['ุจุฑูุงูุฌ', 'ุจุฑุงูุฌ', 'ุณููุช', 'software', 'ุชุทุจูู', 'ุชุทุจููุงุช', 'coordcalc', 'calc',
                          'ุนูุฏูู ุจุฑุงูุฌ', 'ููู ุจุฑุงูุฌ', 'ูุญุชุงุฌ ุจุฑูุงูุฌ', 'ุจุฑุงูุฌ ูุณุงุญูุฉ', 'ุณููุช ููุฑ',
                          'ุชุทุจูู ูุณุงุญุฉ', 'ุจุฑูุงูุฌ ุญุณุงุจุงุช', 'ุนุงูุฒ ุจุฑูุงูุฌ', 'ุงุญุชุงุฌ ุชุทุจูู'],
                response: '๐ป **ุงูุจุฑุงูุฌ ุงููุณุงุญูุฉ ุงูุญุตุฑูุฉ:**\n\n' +
                         '๐ฅ **ุจุฑุงูุฌ ูู ุชุทููุฑูุง - ุบูุฑ ูุชููุฑุฉ ูู ุฃู ููุงู!**\n\n' +
                         '**1๏ธโฃ CoordCalc Pro**\n' +
                         '   โข ุญุงุณุจุฉ ุฅุญุฏุงุซูุงุช ูุชูุฏูุฉ\n' +
                         '   โข ุชุญููู ุจูู WGS84, UTM\n' +
                         '   โข ุญุณุงุจ ุงููุณุงูุงุช ูุงูุฒูุงูุง\n\n' +
                         '**2๏ธโฃ SurveyAnalyzer**\n' +
                         '   โข ุชุญููู ุงูุจูุงูุงุช ุงููุณุงุญูุฉ\n' +
                         '   โข ูุดู ุงูุฃุฎุทุงุก ุชููุงุฆูุงู\n' +
                         '   โข ุชูุงุฑูุฑ ุงุญุชุฑุงููุฉ\n\n' +
                         '**3๏ธโฃ AreaVolume Calc**\n' +
                         '   โข ุญุณุงุจ ุงููุณุงุญุงุช ูุงูุญุฌูู\n' +
                         '   โข Cut & Fill ุจุฏูุฉ\n' +
                         '   โข ุชุตุฏูุฑ ููู Excel\n\n' +
                         '**4๏ธโฃ MapMaker Pro**\n' +
                         '   โข ุฅูุชุงุฌ ุฎุฑุงุฆุท ุงุญุชุฑุงููุฉ\n' +
                         '   โข Contour Lines ุชููุงุฆู\n' +
                         '   โข Layout ุฌุงูุฒ ููุทุจุงุนุฉ\n\n' +
                         '**5๏ธโฃ DataConverter**\n' +
                         '   โข ุชุญููู ุตูุบ ุงููููุงุช\n' +
                         '   โข ุฏุนู ุฌููุน ุฃุฌูุฒุฉ ุงููุณุงุญุฉ\n\n' +
                         '**6๏ธโฃ TraverseCalc**\n' +
                         '   โข ุญุณุงุจุงุช ุงููุถูุนุงุช\n' +
                         '   โข ุชุตุญูุญ ุชููุงุฆู ููุฃุฎุทุงุก\n\n' +
                         'โจ **ุงููููุฒุงุช:**\n' +
                         '   โ ุฑุฎุตุฉ ุฏุงุฆูุฉ (ุฏูุนุฉ ูุงุญุฏุฉ)\n' +
                         '   โ ุชุญุฏูุซุงุช ูุฌุงููุฉ ูุฏู ุงูุญูุงุฉ\n' +
                         '   โ ุฏุนู ููู ูุณุชูุฑ\n' +
                         '   โ ุชุฏุฑูุจ ูุฌุงูู\n\n' +
                         '๐ฐ ุนูุฏูุง **ุจุงูุงุช** ุจุฃุณุนุงุฑ ุฎุงุตุฉ!\n' +
                         'ุนุงูุฒ ุชุนุฑู ุงูุณุนุฑุ ุชูุงุตู ูุนุงูุง! ๐'
            },
            
            prices: {
                keywords: ['ุณุนุฑ', 'ุงุณุนุงุฑ', 'ูุงู', 'ุจูุงู', 'ุชูููุฉ', 'ูููุณ', 'price', 'ุชูู', 'ูู ุงูุณุนุฑ',
                          'ุงูู ุงูุณุนุฑ', 'ุงูุณุนุฑ ูุงู', 'ููููู ูุงู', 'ุงูุงุณุนุงุฑ ุงูู', 'ุงูุชูููุฉ',
                          'ุบุงูู', 'ุฑุฎูุต', 'ูููู ุงุนุฑู ุงูุณุนุฑ', 'ุนุงูุฒ ุงุนุฑู', 'ูู ูููู',
                          'cost', 'pricing', 'ูููุฉ', 'ูุจูุบ', 'ุซูู', 'ุณุนุฑู', 'ุงุณุนุงุฑู',
                          'ุจุชุงุฎุฏูุง ูุงู', 'ุชููู', 'ูููุชู', 'ุงูุฌุงุฑ ูุงู', 'ุงูููุฑุณ ุจูุงู',
                          'ุงูุจุฑูุงูุฌ ุจูุงู', 'ุงูุฌูุงุฒ ุจูุงู', 'ุงููุฑูู ุจูุงู', 'ุชูููู',
                          'ูู ุชูููุฉ', 'ูู ุณุนุฑ', 'ูุง ูู ุงูุณุนุฑ', 'ูู ุงูุซูู', 'ูู ุบุงูู',
                          'ุฑุฎูุต ููุง ุบุงูู', 'ูู ุญุฏูุฏ ูุงู', 'ุงูููุฒุงููุฉ', 'budget'],
                response: '๐ฐ **ุจุฎุตูุต ุงูุฃุณุนุงุฑ:**\n\n' +
                         'ุงูุฃุณุนุงุฑ ุจุชุฎุชูู ุญุณุจ:\n' +
                         '   โข ููุน ุงูุฎุฏูุฉ ุงููุทููุจุฉ\n' +
                         '   โข ุงููุฏุฉ (ููู/ุฃุณุจูุน/ุดูุฑ)\n' +
                         '   โข ุญุฌู ุงููุดุฑูุน\n' +
                         '   โข ุงููููุน ูุงููุณุงูุฉ\n\n' +
                         'โ **ุนุดุงู ูุฏูู ุนุฑุถ ุณุนุฑ ุฏููู:**\n' +
                         'ูุงุฒู ูุนุฑู ุงุญุชูุงุฌุงุชู ุจุงูุธุจุท!\n\n' +
                         '๐ฑ **ุชูุงุตู ูุนุงูุง ุฏูููุชู ููุนุฑูุฉ ุงูุณุนุฑ:**\n' +
                         '   ๐ ููุจุงูู: 01153611556\n' +
                         '   ๐ ููุจุงูู: 01021313489\n' +
                         '   ๐ง ุงูููู: egyptioncontractingservay@gmail.com\n\n' +
                         '๐ก **ุงูุฃุณุนุงุฑ ุนูุฏูุง ุชูุงูุณูุฉ ุฌุฏุงู!**\n' +
                         '   โ ุฌูุฏุฉ ุนุงููุฉ\n' +
                         '   โ ุฃูุถู ุณุนุฑ ูู ุงูุณูู\n' +
                         '   โ ุฎุตููุงุช ูููุดุงุฑูุน ุงููุจูุฑุฉ\n\n' +
                         'ุงุถุบุท ุฒุฑ ูุงุชุณุงุจ ุชุญุช ุนุดุงู ูุชููู ูุจุงุดุฑุฉ! ๐'
            },
            
            projects: {
                keywords: ['ูุดุงุฑูุน', 'ูุดุฑูุน', 'ุงุนูุงู', 'ุดุบู', 'ุฃุนูุงู', 'ุงุดุชุบูุชูุง', 'ุนููุชูุง',
                          'projects', 'ุดุงุฑูุชู', 'ุงุนูุงููู', 'ุณุงุจูุฉ ุงุนูุงู', 'portfolio', 'ุฎุจุฑุฉ',
                          'ุดุบูุชูุง ููู', 'ุงุดุชุบูุชู ููู', 'ูุดุงุฑูุนูู ุงูู', 'ุนููุชูุง ุงูู ูุจู ูุฏู'],
                response: '๐๏ธ **ูุดุงุฑูุนูุง ุงูููุฌุฒุฉ:**\n\n' +
                         '**โญ ูุดุงุฑูุน ููููุฉ ูุจุฑู:**\n\n' +
                         '**1๏ธโฃ ูุญุทุฉ ุงูุถุจุนุฉ ุงูููููุฉ**\n' +
                         '   โข ุฃุนูุงู ูุณุงุญุฉ ุดุงููุฉ\n' +
                         '   โข ุฏูุฉ ุนุงููุฉ ุฌุฏุงู\n' +
                         '   โข ูุดุฑูุน ุงุณุชุฑุงุชูุฌู\n\n' +
                         '**2๏ธโฃ ุงูุนุงุตูุฉ ุงูุฅุฏุงุฑูุฉ ุงูุฌุฏูุฏุฉ**\n' +
                         '   โข ุฑูุน ูุณุงุญู ูููุจุงูู\n' +
                         '   โข ุดุจูุงุช ุงูุจููุฉ ุงูุชุญุชูุฉ\n' +
                         '   โข ูุดุงุฑูุน ูุชุนุฏุฏุฉ\n\n' +
                         '**3๏ธโฃ ูุดุฑูุน ุงูููุนุฉ**\n' +
                         '   โข ุฃุนูุงู ุชูููุฐูุฉ\n' +
                         '   โข ูุชุงุจุนุฉ ุฏูููุฉ\n\n' +
                         '**4๏ธโฃ ูุดุงุฑูุน ุงูุฅุณูุงู ุงูุงุฌุชูุงุนู**\n' +
                         '   โข ูู ูุญุงูุธุงุช ูุชุนุฏุฏุฉ\n' +
                         '   โข ุขูุงู ุงููุญุฏุงุช\n\n' +
                         '**5๏ธโฃ ุงูุทุฑู ูุงููุจุงุฑู ุงูููููุฉ**\n' +
                         '   โข ูุญุงูุฑ ุฑุฆูุณูุฉ\n' +
                         '   โข ุฃููุงู ูุฌุณูุฑ\n\n' +
                         '๐ **ุฃุฑูุงููุง:**\n' +
                         '   โ 500+ ูุดุฑูุน ููุฌุฒ\n' +
                         '   โ 15+ ุณูุฉ ุฎุจุฑุฉ\n' +
                         '   โ 1500+ ููุทุฉ ุฑุตุฏ\n' +
                         '   โ 100% ุฏูุฉ ููุฌุงุญ\n\n' +
                         'ุนูุฏู ูุดุฑูุนุ ููุฏุฑ ูุณุงุนุฏู! ๐ช'
            },
            
            location: {
                keywords: ['ุนููุงู', 'ูููุน', 'ููุงู', 'ููู', 'location', 'address', 'where', 'ููุฌูุฏูู ููู',
                          'ุงูููุชุจ ููู', 'ุงุฒููู', 'ูููู', 'ุงูุนููุงู', 'ุชูุฌูุง ููู', 'ุงุฌูููู ููู',
                          'ููุฑูู', 'ููุฑ ุงูุดุฑูุฉ', 'ุงูุดุฑูุฉ ููู'],
                response: '๐ **ูููุนูุง ูุชุบุทูุชูุง:**\n\n' +
                         '๐ข **ุงูููุฑ ุงูุฑุฆูุณู:**\n' +
                         '   ุงูุฌูุฒุฉ - ุงููุฑู\n' +
                         '   ุนูุงุฑุฉ 2 ุดุงุฑุน ุงูุซูุฑุฉ\n' +
                         '   ูู ุณูู ุญูุฒุฉ\n\n' +
                         '๐บ๏ธ **ูุดุชุบู ูู ูู ูุตุฑ:**\n' +
                         '   โ ุงููุงูุฑุฉ ุงููุจุฑู\n' +
                         '   โ ุงูุฅุณููุฏุฑูุฉ\n' +
                         '   โ ุงูุตุนูุฏ (ุฃุณููุทุ ุณููุงุฌุ ููุง)\n' +
                         '   โ ุงูุฏูุชุง (ุงูููุตูุฑุฉุ ุทูุทุงุ ุงูุฒูุงุฒูู)\n' +
                         '   โ ููุงุฉ ุงูุณููุณ (ุงูุฅุณูุงุนูููุฉุ ุจูุฑุณุนูุฏ)\n' +
                         '   โ ุงูุจุญุฑ ุงูุฃุญูุฑ (ุงูุบุฑุฏูุฉุ ุดุฑู ุงูุดูุฎ)\n' +
                         '   โ ูุทุฑูุญ ูุงูุณุงุญู ุงูุดูุงูู\n' +
                         '   โ ุงููุงุฏู ุงูุฌุฏูุฏ\n\n' +
                         '๐ **ุฎุฏูุฉ ุงูุชูุตูู:**\n' +
                         '   โข ููุตู ุงูุฃุฌูุฒุฉ ูุฃู ูุญุงูุธุฉ\n' +
                         '   โข ุงููุฑู ุชูุฌู ูุฃู ููุงู\n\n' +
                         '๐ ุงุชุตู: 01153611556'
            },
            
            contact: {
                keywords: ['ุชูุงุตู', 'ุงุชุตุงู', 'ุฑูู', 'ุชููููู', 'ููุจุงูู', 'whatsapp', 'ูุงุชุณ', 'ุงุชุตู',
                          'phone', 'call', 'ุงูููู', 'email', 'mail', 'ููููู', 'ุงููููู', 'ูุญุชุงุฌ ุงููููู',
                          'ุนุงูุฒ ุงุชูุงุตู', 'ูููู ุฑูููู', 'ุงุฒุงู ุงุชูุงุตู', 'ุงูู ุงูุฑูู', 'contact'],
                response: '๐ฑ **ุทุฑู ุงูุชูุงุตู ูุนุงูุง:**\n\n' +
                         '**๐ ุงูููุจุงูู:**\n' +
                         '   โข 01153611556 (ูุงุชุณุงุจ ูุชุงุญ)\n' +
                         '   โข 01021313489\n' +
                         '   โข ูุชุงุญูู 24/7 ููุทูุงุฑุฆ\n\n' +
                         '**๐ง ุงูุฅูููู:**\n' +
                         '   egyptioncontractingservay@gmail.com\n' +
                         '   mos562004@gmail.com\n\n' +
                         '**โฐ ุณุงุนุงุช ุงูุนูู:**\n' +
                         '   โข ุงูุณุจุช - ุงูุฎููุณ: 9 ุต - 6 ู\n' +
                         '   โข ุงูุฌูุนุฉ: ูุบูู\n' +
                         '   โข ุฎุฏูุฉ ุทูุงุฑุฆ 24/7 ๐จ\n\n' +
                         '**๐ ุงูุณูุดูุงู ููุฏูุง:**\n' +
                         '   โข Facebook: ECS Egypt\n' +
                         '   โข LinkedIn: ECS Engineering\n\n' +
                         '๐ฌ **ุงูุชูุงุตู ุงูุณุฑูุน:**\n' +
                         'ุงุถุบุท ุนูู ุฒุฑ ุงููุงุชุณุงุจ ุชุญุช ุนุดุงู ูุฑุฏ ุนููู ููุฑุงู! ๐'
            },
            
            default: [
                'ุนุฐุฑุงูุ ูุด ูุชุฃูุฏ ุงูู ูููุช ุณุคุงูู ุตุญ ๐ค\n\nูููู ุชูุถุญ ุฃูุชุฑุ\n\nุฃู ุงุฎุชุงุฑ ูู ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ:\nโข ุงูุฎุฏูุงุช ูุงูุฃุฌูุฒุฉ\nโข ุงูููุฑุณุงุช ูุงูุชุฏุฑูุจ\nโข ุงูุฃุณุนุงุฑ ูุงูุชูุงุตู',
                'ูุนูุดุ ูุด ูุงุถุญุฉ ุนููู! ๐\n\nูููู ุชุนูุฏ ุงูุณุคุงู ุจุทุฑููุฉ ุชุงููุฉุ\n\nุฃู ุงุณุฃููู ุนู:\nโ ุงูุฎุฏูุงุช\nโ ุงูุฃุฌูุฒุฉ\nโ ุงููุฑู\nโ ุงูููุฑุณุงุช\nโ ุงูุจุฑุงูุฌ\nโ ุงูุฃุณุนุงุฑ',
                'ุขุณูุ ูุญุชุงุฌ ุชูุถูุญ ุฃูุชุฑ ๐\n\nุฌุฑุจ ุชุณุฃู ุนู:\nโข ุฎุฏูุงุชูุง ุงููุณุงุญูุฉ\nโข ุงูุฃุฌูุฒุฉ ุงููุชุงุญุฉ\nโข ุงูุฏูุฑุงุช ุงูุชุฏุฑูุจูุฉ\nโข ุงูุจุฑุงูุฌ ุงูุญุตุฑูุฉ\nโข ุทุฑู ุงูุชูุงุตู'
            ],
            
            workingHours: {
                keywords: ['ุณุงุนุงุช', 'ููุงุนูุฏ', 'ูุชู', 'ุงูุชู', 'working', 'hours', 'schedule', 'timing',
                          'ุจุชุดุชุบููุง ุงูุชู', 'ููุชูุญูู ุงูุชู', 'ุงูุนูู', 'ุงูุฏูุงู', 'ุดุบุงููู',
                          'ููุงุนูุฏ ุงูุนูู', 'ุจุชูุชุญูุง', 'ุจุชููููุง'],
                response: 'โฐ **ููุงุนูุฏ ุงูุนูู:**\n\n' +
                         '**๐๏ธ ุฃูุงู ุงูุฃุณุจูุน:**\n' +
                         '   ุงูุณุจุช - ุงูุฎููุณ\n' +
                         '   ูู 9:00 ุตุจุงุญุงู โ 6:00 ูุณุงุกู\n\n' +
                         '**๐ ููู ุงูุฌูุนุฉ:**\n' +
                         '   ูุบูู (ุฅุฌุงุฒุฉ)\n\n' +
                         '**๐จ ุฎุฏูุฉ ุงูุทูุงุฑุฆ:**\n' +
                         '   ูุชุงุญุฉ 24/7\n' +
                         '   ููุญุงูุงุช ุงูุนุงุฌูุฉ ููุท\n\n' +
                         'ุนุงูุฒ ุชุญุฌุฒ ููุนุฏุ ููููุง! ๐'
            },
            
            experience: {
                keywords: ['ุฎุจุฑุฉ', 'ุฎุจุฑุชูู', 'ุณููุงุช', 'experience', 'ูุฏูุชูุง', 'ููุฐ', 'established',
                          'ูุงู ุณูุฉ', 'ุณูุฉ ุฎุจุฑุฉ', 'ุฎุจุฑุงุชูู', 'ุฎุจุฑุชูู ูุฏ ุงูู'],
                response: '๐ **ุฎุจุฑุชูุง:**\n\n' +
                         '**๐ 15+ ุณูุฉ**\n' +
                         'ูู ูุฌุงู ุงููุณุงุญุฉ ูุงูููุฏุณุฉ ุงููุฏููุฉ\n\n' +
                         '**๐ ุฅูุฌุงุฒุงุชูุง:**\n' +
                         '   โ 500+ ูุดุฑูุน ููุฌุฒ\n' +
                         '   โ 1500+ ููุทุฉ ุฑุตุฏ\n' +
                         '   โ 100% ูุนุฏู ูุฌุงุญ\n' +
                         '   โ ุตูุฑ ุฃุฎุทุงุก ูู ุงููุดุงุฑูุน ุงููุจุฑู\n\n' +
                         '**๐ ุดุงุฑููุง ูู:**\n' +
                         '   โข ูุญุทุฉ ุงูุถุจุนุฉ ุงูููููุฉ\n' +
                         '   โข ุงูุนุงุตูุฉ ุงูุฅุฏุงุฑูุฉ\n' +
                         '   โข ูุดุงุฑูุน ููููุฉ ุถุฎูุฉ\n\n' +
                         'ุฎุจุฑุฉ ุชุซู ูููุง! ๐ช'
            },
            
            accuracy: {
                keywords: ['ุฏูุฉ', 'ุฏูููุฉ', 'accuracy', 'precise', 'ูุฏ ุงูู ุฏููููู', 'ุงูุฏูุฉ',
                          'ุฏูุชูู', 'ูุถุจูุท', 'ุตุญ', 'ุบูุท'],
                response: '๐ฏ **ุฏูุชูุง:**\n\n' +
                         '**๐ ุฏูุฉ ุงูุฃุฌูุฒุฉ:**\n' +
                         '   โข ุญุชู 0.5 ุซุงููุฉ ููุณูุฉ\n' +
                         '   โข ุฏูุฉ ุงูููููุชุฑ ูู ุงูููุงุณ\n' +
                         '   โข ุฃุฌูุฒุฉ ูุนุงูุฑุฉ ุญุฏูุซุฉ\n\n' +
                         '**โ ุฏูุฉ ุงูุนูู:**\n' +
                         '   โ 100% ูู ุงููุดุงุฑูุน ุงูููููุฉ\n' +
                         '   โ ุตูุฑ ุฃุฎุทุงุก\n' +
                         '   โ ูุฑุงุฌุนุฉ ุซูุงุซูุฉ\n' +
                         '   โ Quality Control ุตุงุฑู\n\n' +
                         '**๐ ูุนุงููุฑ ุนุงูููุฉ:**\n' +
                         '   โข ISO Certified\n' +
                         '   โข ุงุนุชูุงุฏุงุช ุฏูููุฉ\n\n' +
                         'ุฏูุฉ ุชูุงูุณ ุงูููุงู! โก'
            },
            
            delivery: {
                keywords: ['ุชูุตูู', 'delivery', 'ูุชูุตููุง', 'ุชูุฌูุง', 'ุดุญู', 'ููู',
                          'ูููู ุชูุตููุง', 'ุจุชูุตููุง', 'ุจุชูุฌูุง'],
                response: '๐ **ุฎุฏูุฉ ุงูุชูุตูู:**\n\n' +
                         '**โ ููุตู ููู ูุตุฑ:**\n' +
                         '   โข ุงููุงูุฑุฉ ูุงูุฌูุฒุฉ (ูุฌุงูู)\n' +
                         '   โข ุจุงูู ุงููุญุงูุธุงุช (ุจุฑุณูู)\n\n' +
                         '**๐ฆ ููุตู:**\n' +
                         '   โ ุงูุฃุฌูุฒุฉ ุงููุณุงุญูุฉ\n' +
                         '   โ ุงูููุญูุงุช ูุงููุนุฏุงุช\n' +
                         '   โ ุงูุชุฏุฑูุจ ูู ุงููููุน\n\n' +
                         '**โก ุณุฑุนุฉ ุงูุชูุตูู:**\n' +
                         '   โข ููุณ ุงูููู (ุงููุงูุฑุฉ)\n' +
                         '   โข 1-2 ููู (ุงููุญุงูุธุงุช)\n\n' +
                         '**๐ก๏ธ ุขูู ููุถููู:**\n' +
                         '   โ ุชุฃููู ุดุงูู\n' +
                         '   โ ุชุบููู ุงุญุชุฑุงูู\n\n' +
                         'ุงุทูุจ ุฏูููุชู! ๐'
            },
            
            payment: {
                keywords: ['ุฏูุน', 'payment', 'ุงูุฏูุน', 'ุงุฒุงู ุงุฏูุน', 'ุทุฑููุฉ ุงูุฏูุน', 'ูุงุด', 'cash',
                          'ููุฒุง', 'visa', 'ุชูุณูุท', 'installment', 'ูุฏูุน ุงุฒุงู'],
                response: '๐ณ **ุทุฑู ุงูุฏูุน ุงููุชุงุญุฉ:**\n\n' +
                         '**1๏ธโฃ ูุงุด (ููุฏู):**\n' +
                         '   โข ุนูุฏ ุงูุงุณุชูุงู\n' +
                         '   โข ูู ุงูููุชุจ\n\n' +
                         '**2๏ธโฃ ุชุญููู ุจููู:**\n' +
                         '   โข ุนูู ุญุณุงุจ ุงูุดุฑูุฉ\n' +
                         '   โข ููุฑู ุฃู InstaPay\n\n' +
                         '**3๏ธโฃ ุจุทุงูุงุช ุงูุงุฆุชูุงู:**\n' +
                         '   โข Visa\n' +
                         '   โข Mastercard\n\n' +
                         '**4๏ธโฃ ุดููุงุช:**\n' +
                         '   โข ููุดุฑูุงุช ูุงููุคุณุณุงุช\n\n' +
                         '**๐ ุชุณูููุงุช:**\n' +
                         '   โ ุฅููุงููุฉ ุงูุชูุณูุท (ูููุดุงุฑูุน ุงููุจูุฑุฉ)\n' +
                         '   โ ููุงุชูุฑ ุถุฑูุจูุฉ\n' +
                         '   โ ุนููุฏ ุฑุณููุฉ\n\n' +
                         'ููููุง ุนุดุงู ูุชูู ุนูู ุงูุทุฑููุฉ ุงูููุงุณุจุฉ! ๐'
            },
            
            certificate: {
                keywords: ['ุดูุงุฏุฉ', 'ุดูุงุฏุงุช', 'certificate', 'certification', 'ูุนุชูุฏ', 'ุงุนุชูุงุฏ',
                          'ูุงุฎุฏ ุดูุงุฏุฉ', 'ููู ุดูุงุฏุฉ', 'ุงูุดูุงุฏุฉ ูุนุชูุฏุฉ'],
                response: '๐ **ุงูุดูุงุฏุงุช:**\n\n' +
                         '**๐ ููููุฑุณุงุช:**\n' +
                         '   โ ุดูุงุฏุฉ ูุนุชูุฏุฉ ูู ECS\n' +
                         '   โ ูุนุชุฑู ุจููุง ูู ุงูุณูู\n' +
                         '   โ ุชููุฏ ูู ุงูุชูุธูู\n' +
                         '   โ ูุฑููุฉ + ุฑูููุฉ (PDF)\n\n' +
                         '**๐ ูููุฒุงุช ุงูุดูุงุฏุฉ:**\n' +
                         '   โข ุจุงููุบุชูู (ุนุฑุจู/ุฅูุฌููุฒู)\n' +
                         '   โข ุชุญูู ุฎุชู ุงูุดุฑูุฉ\n' +
                         '   โข ูุงุจูุฉ ููุชุญูู ูููุง\n' +
                         '   โข ุชุชุถูู ุงูููุงุฑุงุช ุงูููุชุณุจุฉ\n\n' +
                         '**โ ุดุฑูุท ุงูุญุตูู ุนูููุง:**\n' +
                         '   1. ุญุถูุฑ 80%+ ูู ุงูููุฑุณ\n' +
                         '   2. ุงุฌุชูุงุฒ ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู\n' +
                         '   3. ุชุณููู ุงููุดุฑูุน ุงูุนููู\n\n' +
                         'ุนุงูุฒ ุชุญุตู ุนูู ุดูุงุฏุฉุ ุณุฌูู ูู ููุฑุณ! ๐'
            },
            
            guarantee: {
                keywords: ['ุถูุงู', 'guarantee', 'warranty', 'ูุถููู', 'ุงูุถูุงู', 'ููู ุถูุงู',
                          'ุจุชุถูููุง', 'ูู ุญุตู ูุดููุฉ'],
                response: '๐ก๏ธ **ุงูุถูุงู ูุงูุฌูุฏุฉ:**\n\n' +
                         '**ููุฃุฌูุฒุฉ ุงููุคุฌุฑุฉ:**\n' +
                         '   โ ุตูุงูุฉ ุฏูุฑูุฉ ูุฌุงููุฉ\n' +
                         '   โ ุงุณุชุจุฏุงู ููุฑู ูู ุญุงูุฉ ุงูุนุทู\n' +
                         '   โ ุฏุนู ููู 24/7\n' +
                         '   โ ุชุฏุฑูุจ ูุฌุงูู ุนูู ุงูุงุณุชุฎุฏุงู\n\n' +
                         '**ููุจุฑุงูุฌ:**\n' +
                         '   โ ุถูุงู ุงุณุชุฑุฌุงุน (14 ููู)\n' +
                         '   โ ุชุญุฏูุซุงุช ูุฌุงููุฉ ูุฏู ุงูุญูุงุฉ\n' +
                         '   โ ุฏุนู ููู ูุณุชูุฑ\n\n' +
                         '**ููุฎุฏูุงุช:**\n' +
                         '   โ ุถูุงู ุงูุฏูุฉ 100%\n' +
                         '   โ ุฅุนุงุฏุฉ ุงูุนูู ูุฌุงูุงู ูู ุญุงูุฉ ุฎุทุฃ\n' +
                         '   โ ุชุฃููู ุดุงูู ุนูู ุงููุนุฏุงุช\n\n' +
                         '**๐ ุนููุฏ ุฑุณููุฉ:**\n' +
                         '   โข ูู ุดูุก ููุซู\n' +
                         '   โข ุญูููู ูุญููุธุฉ\n\n' +
                         'ุฑุงุญุชู ูุซูุชู ุฃููููุชูุง! ๐ค'
            }
        };
    }

    init() {
        this.createChatbotHTML();
        this.attachEventListeners();
        this.showWelcomeMessage();
    }

    createChatbotHTML() {
        const chatbotHTML = `
            <!-- Chatbot Toggle Button -->
            <div class="chatbot-toggle" id="chatbotToggle">
                <i class="fas fa-comments"></i>
            </div>

            <!-- Chatbot Container -->
            <div class="chatbot-container" id="chatbotContainer">
                <!-- Header -->
                <div class="chatbot-header">
                    <div class="chatbot-header-info">
                        <div class="chatbot-avatar">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="chatbot-header-text">
                            <h3>ูุณุงุนุฏ ECS ุงูุฐูู</h3>
                            <div class="chatbot-status">
                                <span class="status-dot"></span>
                                <span class="status-text">ูุชุตู ุงูุขู</span>
                            </div>
                        </div>
                    </div>
                    <button class="chatbot-close" id="chatbotClose">
                        <i class="fas fa-times"></i>
                    </button>
                </div>

                <!-- Messages Area -->
                <div class="chatbot-messages" id="chatbotMessages">
                    <!-- Messages will be inserted here -->
                </div>

                <!-- Quick Replies -->
                <div class="quick-replies" id="quickReplies">
                    <button class="quick-reply-btn" data-query="ูุง ูู ุฎุฏูุงุชููุ">๐ง ุงูุฎุฏูุงุช</button>
                    <button class="quick-reply-btn" data-query="ุฃุฌูุฒุฉ ููุฅูุฌุงุฑ">๐ก ุงูุฃุฌูุฒุฉ</button>
                    <button class="quick-reply-btn" data-query="ุงูููุฑุณุงุช ุงููุชุงุญุฉ">๐ ุงูููุฑุณุงุช</button>
                    <button class="quick-reply-btn" data-query="ุงูุจุฑุงูุฌ ุงููุณุงุญูุฉ">๐ป ุงูุจุฑุงูุฌ</button>
                    <button class="quick-reply-btn" data-query="ูุฑู ูุณุงุญูุฉ">๐ท ุงููุฑู</button>
                    <button class="quick-reply-btn" data-query="ุงูุฃุณุนุงุฑ">๐ฐ ุงูุฃุณุนุงุฑ</button>
                    <button class="quick-reply-btn" data-query="ูุนูููุงุช ุงูุชูุงุตู">๐ ุงูุชูุงุตู</button>
                    <button class="quick-reply-btn" data-query="ุงูุนููุงู">๐ ุงููููุน</button>
                </div>

                <!-- Input Area -->
                <div class="chatbot-input-area">
                    <input 
                        type="text" 
                        class="chatbot-input" 
                        id="chatbotInput" 
                        placeholder="ุงูุชุจ ุณุคุงูู ููุง..."
                        autocomplete="off"
                    >
                    <button class="chatbot-send" id="chatbotSend">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        `;

        document.body.insertAdjacentHTML('beforeend', chatbotHTML);
    }

    attachEventListeners() {
        const toggle = document.getElementById('chatbotToggle');
        const close = document.getElementById('chatbotClose');
        const send = document.getElementById('chatbotSend');
        const input = document.getElementById('chatbotInput');
        const quickReplies = document.querySelectorAll('.quick-reply-btn');

        toggle.addEventListener('click', () => this.toggleChat());
        close.addEventListener('click', () => this.closeChat());
        send.addEventListener('click', () => this.sendMessage());
        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') this.sendMessage();
        });

        quickReplies.forEach(btn => {
            btn.addEventListener('click', () => {
                const query = btn.getAttribute('data-query');
                this.sendMessage(query);
            });
        });
    }

    toggleChat() {
        const container = document.getElementById('chatbotContainer');
        const toggle = document.getElementById('chatbotToggle');
        container.classList.toggle('active');
        toggle.classList.toggle('active');
        
        if (container.classList.contains('active')) {
            document.getElementById('chatbotInput').focus();
        }
    }

    closeChat() {
        const container = document.getElementById('chatbotContainer');
        const toggle = document.getElementById('chatbotToggle');
        container.classList.remove('active');
        toggle.classList.remove('active');
    }

    showWelcomeMessage() {
        setTimeout(() => {
            const welcomeMsg = this.responses.greetings[Math.floor(Math.random() * this.responses.greetings.length)];
            this.addBotMessage(welcomeMsg);
        }, 1000);
    }

    sendMessage(text = null) {
        const input = document.getElementById('chatbotInput');
        const message = text || input.value.trim();

        if (!message) return;

        this.addUserMessage(message);
        input.value = '';

        this.showTypingIndicator();
        
        setTimeout(() => {
            this.hideTypingIndicator();
            const response = this.getResponse(message);
            this.addBotMessage(response);
            
            // Show WhatsApp button for certain queries
            if (this.shouldShowWhatsApp(message)) {
                this.addWhatsAppButton();
            }
        }, 1000 + Math.random() * 1000);
    }

    getResponse(message) {
        const lowerMessage = message.toLowerCase()
                                   .replace(/ู|ู|ู|ู|ู|ู|ู|ู/g, '') // Remove diacritics
                                   .trim();

        // HIGHEST PRIORITY: Check for price questions FIRST
        // This ensures ANY price-related question gets proper response
        if (this.checkCategory(lowerMessage, 'prices')) {
            return this.responses.prices.response;
        }

        // Check for thanks
        if (this.checkCategory(lowerMessage, 'thanks')) {
            return this.responses.thanks.response;
        }

        // Check for help requests
        if (this.checkCategory(lowerMessage, 'help')) {
            return this.responses.help.response;
        }

        // Check greetings
        if (this.isGreeting(lowerMessage)) {
            return this.responses.greetings[Math.floor(Math.random() * this.responses.greetings.length)];
        }

        // Check working hours
        if (this.checkCategory(lowerMessage, 'workingHours')) {
            return this.responses.workingHours.response;
        }

        // Check experience questions
        if (this.checkCategory(lowerMessage, 'experience')) {
            return this.responses.experience.response;
        }

        // Check accuracy questions
        if (this.checkCategory(lowerMessage, 'accuracy')) {
            return this.responses.accuracy.response;
        }

        // Check delivery questions
        if (this.checkCategory(lowerMessage, 'delivery')) {
            return this.responses.delivery.response;
        }

        // Check payment questions
        if (this.checkCategory(lowerMessage, 'payment')) {
            return this.responses.payment.response;
        }

        // Check certificate questions
        if (this.checkCategory(lowerMessage, 'certificate')) {
            return this.responses.certificate.response;
        }

        // Check guarantee questions
        if (this.checkCategory(lowerMessage, 'guarantee')) {
            return this.responses.guarantee.response;
        }

        // Check each main category
        const categories = ['services', 'equipment', 'teams', 'courses', 'software', 'projects', 'location', 'contact'];
        
        for (let category of categories) {
            if (this.checkCategory(lowerMessage, category)) {
                return this.responses[category].response;
            }
        }

        // If nothing matched, return default with context-aware suggestion
        const suggestion = this.getSuggestion(lowerMessage);
        return this.responses.default[Math.floor(Math.random() * this.responses.default.length)] + 
               (suggestion ? '\n\n๐ก ' + suggestion : '');
    }

    checkCategory(message, category) {
        const categoryData = this.responses[category];
        if (!categoryData || !categoryData.keywords) return false;
        
        return categoryData.keywords.some(keyword => message.includes(keyword));
    }

    getSuggestion(message) {
        // PRIORITY: If message contains any price-related word, suggest contact
        const priceWords = ['ุณุนุฑ', 'ูุงู', 'ุชููู', 'ูููุณ', 'price', 'ุบุงูู', 'ุฑุฎูุต', 'ุชูู', 'ุซูู', 'ูุจูุบ'];
        if (priceWords.some(word => message.includes(word))) {
            return 'ููุงุณุชูุณุงุฑ ุนู ุงูุฃุณุนุงุฑุ ุชูุงุตู ูุนุงูุง ุนูู 01153611556 ๐';
        }
        
        // Smart suggestions based on partial matches
        if (message.includes('ุฌูุงุฒ') || message.includes('ูุนุฏ')) {
            return 'ูููู ุชุณุฃู ุนู "ุงูุฃุฌูุฒุฉ ุงููุชุงุญุฉ ููุฅูุฌุงุฑ"';
        }
        if (message.includes('ุชุนู') || message.includes('ุฏุฑุจ') || message.includes('ููุฑุณ')) {
            return 'ุฌุฑุจ ุชุณุฃู ุนู "ุงูููุฑุณุงุช ุงูุชุฏุฑูุจูุฉ"';
        }
        if (message.includes('ุจุฑูุง') || message.includes('ุณููุช')) {
            return 'ุงุณุฃู ุนู "ุงูุจุฑุงูุฌ ุงููุณุงุญูุฉ ุงูุญุตุฑูุฉ"';
        }
        if (message.includes('ูุฑ') || message.includes('ูููุฏ') || message.includes('ููุธู')) {
            return 'ุงุณุฃู ุนู "ุงููุฑู ุงููุณุงุญูุฉ ุงููุชุงุญุฉ"';
        }
        return null;
    }

    isGreeting(message) {
        const greetings = [
            'ูุฑุญุจุง', 'ูุฑุญุจู', 'ุงูุณูุงู', 'ููุง', 'ุงููุง', 'ุฃููุง', 'ุตุจุงุญ', 'ูุณุงุก', 
            'hello', 'hi', 'hey', 'ุณูุงู', 'ุงุฒูู', 'ุงุฒููู', 'ุนุงูู ุงูู', 
            'ุงุญูุงูู', 'ุงุฎุจุงุฑู', 'ูุง ููุง', 'ูุงู', 'ุงูููู', 'ุงูุณูุงูู',
            'ูููู', 'ูู ุณูุญุช', 'ูู ูุถูู', 'ูุงู'
        ];
        
        // Check if message is very short and contains greeting
        if (message.length < 20) {
            return greetings.some(greeting => message.includes(greeting));
        }
        
        // For longer messages, only greeting if it starts with greeting word
        const firstWord = message.split(' ')[0];
        return greetings.some(greeting => firstWord.includes(greeting));
    }

    shouldShowWhatsApp(message) {
        const triggers = ['ุณุนุฑ', 'ุงุณุนุงุฑ', 'ุชูุงุตู', 'ุงุชุตุงู', 'ุญุฌุฒ', 'ุดุฑุงุก'];
        return triggers.some(trigger => message.toLowerCase().includes(trigger));
    }

    addUserMessage(text) {
        const messagesContainer = document.getElementById('chatbotMessages');
        const messageHTML = `
            <div class="message user">
                <div class="message-content">
                    ${this.escapeHTML(text)}
                    <div class="message-time">${this.getCurrentTime()}</div>
                </div>
                <div class="message-avatar">
                    <i class="fas fa-user"></i>
                </div>
            </div>
        `;
        messagesContainer.insertAdjacentHTML('beforeend', messageHTML);
        this.scrollToBottom();
    }

    addBotMessage(text) {
        const messagesContainer = document.getElementById('chatbotMessages');
        const messageHTML = `
            <div class="message bot">
                <div class="message-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="message-content">
                    ${this.formatMessage(text)}
                    <div class="message-time">${this.getCurrentTime()}</div>
                </div>
            </div>
        `;
        messagesContainer.insertAdjacentHTML('beforeend', messageHTML);
        this.scrollToBottom();
    }

    addWhatsAppButton() {
        const messagesContainer = document.getElementById('chatbotMessages');
        const buttonHTML = `
            <div class="message bot">
                <div class="message-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="message-content">
                    <button class="whatsapp-direct" onclick="window.open('https://wa.me/${this.whatsappNumber}?text=ูุฑุญุจุงูุ ุฃุฑูุฏ ุงูุงุณุชูุณุงุฑ ุนู ุฎุฏูุงุชูู', '_blank')">
                        <i class="fab fa-whatsapp"></i>
                        ุชูุงุตู ุนุจุฑ ูุงุชุณุงุจ
                    </button>
                </div>
            </div>
        `;
        messagesContainer.insertAdjacentHTML('beforeend', buttonHTML);
        this.scrollToBottom();
    }

    showTypingIndicator() {
        const messagesContainer = document.getElementById('chatbotMessages');
        const typingHTML = `
            <div class="message bot" id="typingIndicator">
                <div class="message-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="typing-indicator active">
                    <div class="typing-dots">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            </div>
        `;
        messagesContainer.insertAdjacentHTML('beforeend', typingHTML);
        this.scrollToBottom();
    }

    hideTypingIndicator() {
        const indicator = document.getElementById('typingIndicator');
        if (indicator) indicator.remove();
    }

    formatMessage(text) {
        // Format newlines
        text = text.replace(/\n/g, '<br>');
        
        // Format bold text
        text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        
        return text;
    }

    escapeHTML(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }

    getCurrentTime() {
        const now = new Date();
        return now.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' });
    }

    scrollToBottom() {
        const messagesContainer = document.getElementById('chatbotMessages');
        messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }
}

// Initialize chatbot when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    new ECSchatbot();
});
